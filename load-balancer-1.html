<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Building a Strong Engineering Culture - Blog Post</title> 
    <link rel="stylesheet" href="blog.css">
    
</head>
<body>

    <header class="site-header">
        <div class="container">
            <div class="site-logo">
                <a href="#">UnderTheHood</a>
            </div>
            <nav class="main-nav">
                <ul>
                    <li><a href="#">Articles</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="container main-area">

        <main class="content-column">
            <article class="full-post">

                <header class="post-header">
                    <div class="post-tags">
                        <a href="#">Loadbalancing</a>
                        <a href="#">Java</a>
                    </div>
                    <h1 class="post-title">Bulding a Load Balancer Day 01</h1>
                    <div class="post-meta">
                        By <span class="author">Sahariar Alam Khandoker</span> on <span class="date">Jan 1st, 2025</span>
                        </div>
                     </header>

                <div class="post-content">
                    <p>In this series of articles we are going to build a simple load balancer. With following features:</p>
                    <ul>
                        <li><strong>Balance load accross multiple nodes</strong></li>
                        <li><strong>Use different algorightm for load banaling</strong></li>
                        <li><strong>Add headers for both request and response</strong></li>
                        <li><strong>Log request and response timings</strong></li>
                    </ul>

                    <h2>Bulding a echo server</h2>
                    <p>We will first start with building a simple echo server that returns what is received</p>

                    <pre><code>
public class Main {
    public static void main(String[] args) {
        try (ServerSocket serverSocket = new ServerSocket(8888);
             ExecutorService executorService = Executors.newCachedThreadPool()) {

            while (true) {
                Socket socket = serverSocket.accept();
                executorService.execute(() -> {

                    try (InputStream inputStream = socket.getInputStream();
                            OutputStream outputStream = socket.getOutputStream()) {

                        byte[] requestBytes = inputStream.readAllBytes();
                        String request = new String(requestBytes, StandardCharsets.UTF_8);

                        System.out.println("Received Request: \n\n"+request);

                        outputStream.write(requestBytes);

                    } catch (IOException e) {
                        throw new RuntimeException(e);
                    }

                });
            }

        } catch (IOException e) {
            throw new RuntimeException(e);
        }
    }
}</code></pre>

                    <p>In the above code we are using a <code>ServerSocket</code> to listen on port 8888. When a request comes in we are creating a new thread using <code>ExecutorService</code>. The request is read from the input stream and written back to the output stream.</p>

                    <h2>Testing the echo server</h2>
                    <p>We can test the echo server using <code>netcat</code></p>
                    <pre><code>echo "hello world" | nc 127.0.0.1 8888 </code></pre>
                    <p>This should return "hello world"</p>

                    <p>You can find this code here</p>
                    <pre><code>https://github.com/sahariardev/building-simple-load-balancer/blob/master/day01/src/main/java/org/sahariardev/Main.java</code></pre>

                </div>

            </article>
        </main>

        <aside class="sidebar">
            <div class="widget">
                <h3 class="widget-title">Topics</h3>
                <ul>
                    <li><a href="#">Bulding Load Balancer Day 02</a></li>
                    <li><a href="#">Bulding Load Balancer Day 03</a></li>
                    <li><a href="#">Bulding Load Balancer Day 04</a></li>
                </ul>
            </div>
        </aside>

    </div> 
    
    <footer class="site-footer">
        <div class="container">
             <div class="footer-logo">
                 <a href="#">Under<span>The</span><span>Hood</span></a>
             </div>
            <div class="footer-copyright">
                
            </div>
        </div>
    </footer>

</body>
</html>